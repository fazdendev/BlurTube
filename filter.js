const LOOK_OUT_RATE_MILISEC=100,ELEMS_TO_BLUR=['*[class*="video-thumbnail-img"]','*[class*="ytd-thumbnail"] img','*[class*="ytp-videowall-still-image"]','*[class*="ytp-ce-covering-image"]','*[class*="ytd-playlist-thumbnail"]','*[class*="iv-card-image"]'],PARENTS_TO_ELEMS_TO_BLUR=["ytd-thumbnail",'*[class*="ytp-videowall-still"]'],BLUR_ENABLED_FLAG="enabled",BLUR_LOCKED_FLAG="blurLocked",BLUR_LEVEL_FLAG="blurLevel",UNBLUR_AFTER_MILISEC=500,TRANSITION_SPEED=300;let blurLocked=!1,BLUR_LEVEL_PX="50",enabled=!1;const removeExistingFhazingCSS=()=>{const css=document.getElementById("fhazer");css&&css.parentNode.removeChild(css)},removeExistingFhazingTransitionCSS=()=>{const css=document.getElementById("fhazer-transition");css&&css.parentNode.removeChild(css)},injectBlurCSS=blurLevel=>{removeExistingFhazingCSS();let style=document.createElement("style");style.id="fhazer",style.fhazed=!0,style.innerHTML=ELEMS_TO_BLUR.join(",")+"{ filter: blur("+blurLevel+"px);   }",style.insertAdjacentHTML("beforeend",`${PARENTS_TO_ELEMS_TO_BLUR.join(",")} { overflow:hidden;}`);let ref=document.querySelector("script");ref.parentNode.insertBefore(style,ref)},injectBlurTransitionCSS=()=>{removeExistingFhazingTransitionCSS();let style=document.createElement("style");style.id="fhazer-transition",style.fhazed=!0,style.innerHTML=ELEMS_TO_BLUR.join(",")+"{  transition: filter 300ms; }";let ref=document.querySelector("script");ref.parentNode.insertBefore(style,ref)};window.onfocus=()=>{chrome.storage.local.get(["enabled"],data=>{1==data.enabled?(injectBlurCSS(BLUR_LEVEL_PX),injectBlurTransitionCSS()):0==data.enabled&&(removeExistingFhazingCSS(),removeExistingFhazingTransitionCSS())})},chrome.storage.local.get(["enabled"],data=>{!0===data.enabled&&(injectBlurCSS(BLUR_LEVEL_PX),injectBlurTransitionCSS(),enabled=!0)}),chrome.storage.local.get(["blurLocked"],data=>{blurLocked=Boolean(data.blurLocked)}),chrome.storage.local.get(["blurLevel"],data=>{BLUR_LEVEL_PX=data.blurLevel||BLUR_LEVEL_PX,enabled&&(injectBlurCSS(BLUR_LEVEL_PX),injectBlurTransitionCSS())}),chrome.storage.onChanged.addListener((function(changes,namespace){for(let key in changes){let storageChange=changes[key];"enabled"===key&&!0===storageChange.newValue?(injectBlurCSS(BLUR_LEVEL_PX),injectBlurTransitionCSS(),enabled=!0):"enabled"===key&&!1===storageChange.newValue&&(removeExistingFhazingCSS(),removeExistingFhazingTransitionCSS(),clearEventListernerInterval(),enabled=!1)}})),chrome.storage.onChanged.addListener((function(changes,namespace){for(let key in changes){let storageChange=changes[key];"blurLocked"===key&&!0===storageChange.newValue?blurLocked=!0:"blurLocked"===key&&!1===storageChange.newValue&&(blurLocked=!1)}})),chrome.storage.onChanged.addListener((function(changes,namespace){for(let key in changes){let storageChange=changes[key];"blurLevel"===key&&storageChange.newValue&&(BLUR_LEVEL_PX=storageChange.newValue,injectBlurCSS(BLUR_LEVEL_PX),injectBlurTransitionCSS())}}));